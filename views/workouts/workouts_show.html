<!doctype html>
<html>
  <head>
    {{ template "head" }}
    <script src="{{ RouteFor `assets` }}/dist/leaflet.js"></script>
    <link href="{{ RouteFor `assets` }}/dist/leaflet.css" rel="stylesheet" />
  </head>
  <body>
    {{ template "header" . }}
    <div class="content">
      {{ with .workout }}
      <div class="gap-4">
        {{ if eq .User.ID $.currentUser.ID }}
        <span class="float-right actions">
          {{ template "workout_actions" . }}
        </span>
        {{ end }}

        <h2
          class="icon-{{ .Type | FAIconClass }} icon-baseline icon-space-sm icon-before
                    icon-{{ .Type | FAIconName }}"
        >
          {{ .Name | html }}
        </h2>
      </div>
      <div class="grid grid-cols-2 gap-4">
        <div
          id="map"
          class="border-2 border-black rounded-xl"
          style="height: 600px"
        >
          <script>
            let points = [
              {{- range $idx, $pt := .Data.Points }}
              {{  if $idx  }},{{  end -}}
              { "lat": {{  $pt.Lat  }}, "lng": {{  $pt.Lng -}}, "title": {{  $pt.Title  }} }
              {{- end  }}
            ];
            let center = [{{  .Data.Center.Lat  }}, {{  .Data.Center.Lng  }}];
          </script>
          <script src="{{ RouteFor `assets` }}/map.js"></script>
        </div>
        <div class="grid grid-cols-1">
          {{ if .Notes }}
          <div class="inner-form text-sm h-16 hover:h-fit overflow-hidden">
            <div class="flex">
              <div
                class="font-bold rounded-xl icon-solid icon-baseline icon-space-sm icon-before icon-quote-left"
              ></div>
              {{ .Notes }}
            </div>
          </div>
          {{ end }}
          <div class="grid grid-cols-2 gap-4">
            <div class="inner-form">
              <table class="workout-info">
                <tbody>
                  <tr>
                    <td
                      class="icon-regular icon-baseline icon-space-sm icon-before icon-calendar"
                    ></td>
                    <th>Date</th>
                    <td>
                      <span title="{{ .Date | LocalDate }}">
                        {{ .Date | RelativeDate }}
                      </span>
                    </td>
                  </tr>
                  <tr>
                    <td
                      class="icon-solid icon-baseline icon-space-sm icon-before icon-map-location-dot"
                    ></td>
                    <th>Location</th>
                    <td>{{ template "snippet_location" .Data.Address }}</td>
                  </tr>
                  <tr>
                    <td
                      class="icon-solid icon-baseline icon-space-sm icon-before icon-dumbbell"
                    ></td>
                    <th>Type</th>
                    <td>{{ .Type }}</td>
                  </tr>
                  <tr>
                    <td
                      class="icon-regular icon-baseline icon-before icon-space-sm icon-clock"
                    ></td>
                    <th>Total duration</th>
                    <td>{{ .Data.TotalDuration }}</td>
                  </tr>
                  <tr>
                    <td
                      class="icon-solid icon-baseline icon-space-sm icon-before icon-road"
                    ></td>
                    <th>Total distance</th>
                    <td>{{ .Data.TotalDistance | HumanDistance }}</td>
                  </tr>
                  <tr>
                    <td
                      class="icon-solid icon-baseline icon-space-sm icon-before icon-gauge"
                    ></td>
                    <th>Average speed</th>
                    <td>{{ .Data.AverageSpeed | HumanSpeed }}</td>
                  </tr>
                  <tr>
                    <td
                      class="icon-solid icon-baseline icon-space-sm icon-before icon-gauge"
                    ></td>
                    <th>Average speed (no pauze)</th>
                    <td>{{ .Data.AverageSpeedNoPauze | HumanSpeed }}</td>
                  </tr>
                  <tr>
                    <td
                      class="icon-solid icon-baseline icon-space-sm icon-before icon-gauge"
                    ></td>
                    <th>Average tempo</th>
                    <td>{{ .Data.AverageSpeed | HumanTempo }}</td>
                  </tr>
                  <tr>
                    <td
                      class="icon-solid icon-baseline icon-space-sm icon-before icon-gauge"
                    ></td>
                    <th>Average tempo (no pauze)</th>
                    <td>{{ .Data.AverageSpeedNoPauze | HumanTempo }}</td>
                  </tr>
                  <tr>
                    <td
                      class="icon-solid icon-baseline icon-space-sm icon-before icon-gauge-high"
                    ></td>
                    <th>Max speed</th>
                    <td>{{ .Data.MaxSpeed | HumanSpeed }}</td>
                  </tr>
                  <tr>
                    <td
                      class="icon-solid icon-baseline icon-space-sm icon-before icon-hourglass"
                    ></td>
                    <th>Time pauzed</th>
                    <td>{{ .Data.PauzeDuration }}</td>
                  </tr>
                  <tr>
                    <td
                      class="icon-solid icon-baseline icon-space-sm icon-before icon-mountain"
                    ></td>
                    <th>Min elevation</th>
                    <td>{{ .Data.MinElevation | HumanDistance }}</td>
                  </tr>
                  <tr>
                    <td
                      class="icon-solid icon-baseline icon-space-sm icon-before icon-mountain"
                    ></td>
                    <th>Max elevation</th>
                    <td>{{ .Data.MaxElevation | HumanDistance }}</td>
                  </tr>
                  <tr>
                    <td
                      class="icon-solid icon-baseline icon-space-sm icon-before icon-chevron-up"
                    ></td>
                    <th>Total up</th>
                    <td>{{ .Data.TotalUp | HumanDistance }}</td>
                  </tr>
                  <tr>
                    <td
                      class="icon-solid icon-baseline icon-space-sm icon-before icon-chevron-down"
                    ></td>
                    <th>Total down</th>
                    <td>{{ .Data.TotalDown | HumanDistance }}</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="inner-form">
              <table class="workout-info">
                <thead>
                  <tr>
                    <th></th>
                    <th>KM</th>
                    <th>Duration</th>
                    <th>Speed</th>
                    <th>Tempo</th>
                  </tr>
                </thead>
                <tbody>
                  {{ range $.workoutStatistics }}
                  <tr>
                    <td>
                      {{ if .IsWorst }}
                      <span
                        class="icon-baseline icon-space-sm text-orange-600 icon-solid icon-after icon-arrow-down-long"
                      ></span
                      >{{ end }} {{ if .IsBest }}
                      <span
                        class="icon-baseline icon-space-sm text-green-500 icon-solid icon-after icon-arrow-up-long"
                      ></span
                      >{{ end }}
                    </td>
                    <td class="text-center">{{ .Kilometer }}</td>
                    <td>{{ .Duration }}</td>
                    <td>{{ .Speed | HumanSpeed }}</td>
                    <td>{{ .Speed | HumanTempo }}</td>
                  </tr>
                  {{ end }}
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
      {{ end }}
    </div>

    {{ template "footer" . }}
  </body>
</html>
