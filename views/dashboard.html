<!doctype html>
<html>
  <head>
    {{ template "head" }}
  </head>
  <body>
    {{ template "header" . }}
    <div class="content">
      <h2
        class="icon-solid icon-baseline icon-space-sm icon-before icon-chart-line"
      >
        Dashboard
      </h2>

      {{ template "stats_records_total" .UserStatistics.Total }}

      <div class="grid grid-cols-2 gap-4">
        <div>
          <div class="inner-form">
            {{ template "stats_records_running" .UserStatistics.Records }}
          </div>
        </div>
        <div class="inner-form" id="calendar"></div>
        <script src="/assets/fullcalendar.min.js"></script>
        <script>
          document.addEventListener("DOMContentLoaded", function () {
            var calendarEl = document.getElementById("calendar");
            var calendar = new FullCalendar.Calendar(calendarEl, {
              timeZone: "Belgium",
              initialView: "dayGridMonth",
              firstDay: 1,
              aspectRatio: 2,
              eventContent: function(arg) {
                let eventSpan = document.createElement('div')

                eventSpan.innerHTML = arg.event.title
                eventSpan.classList.add(
                  "px-2", "icon-baseline", "icon-before", "icon-space-sm", "overflow-hidden",
                  arg.event.extendedProps.iconClass, arg.event.extendedProps.iconName
                )

                return { domNodes: [ eventSpan ] }
              },
              events: [
                {{ range $idx, $w := .workouts }}
                {
                  title: "{{ $w.Type }}",
                  start: "{{ $w.Date | LocalDate }}",
                  url: "/workouts/{{ $w.ID }}",
                  display: 'block',
                  extendedProps: {
                    iconClass: "icon-{{ $w.Type | FAIconClass }}",
                    iconName: "icon-{{ $w.Type | FAIconName }}",
                  },
                },
                {{ end }}
              ],
            });
            calendar.render();
          });
        </script>
      </div>
    </div>

    {{ template "footer" . }}
  </body>
</html>
